<html>
  <head>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Droid+Sans:700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="../common.css">
    <link rel="stylesheet" href="../common/lib/atom-one-light.css">
    <link rel="stylesheet" href="./openzfs.css">
  </head>
  <body>
    <input type="checkbox" id="showPreview"/>
    <div class="first-side">
      <div class="cutter">
<div class="cut cut-top-left">&nbsp;</div>
<div class="cut cut-bottom-left">&nbsp;</div>
<div class="cut cut-top-right">&nbsp;</div>
<div class="cut cut-bottom-right">&nbsp;</div>
</div>
<header>
    <div class="home-button no-print">
        <a href="../" title="back to home cheat Sheet"><i class="material-icons">home</i></a>
        <label for="showPreview"><i class="material-icons">visibility</i></label>
    </div>
    <div class="header-center">
        <div class="description-content">
            <div class="title">OpenZFS</div>
            <div class="sub-title">The smartest reliable filesystem</div>
        </div>

        <div class="logo-container">
            <img src="../assets/images/openzfs.png">
        </div>
    </div>
    <div class="logo-category no-print">
        <i class="material-icons" onclick="printLarge()">print</i>
    </div>
</header>



      <main>
        <div class="column1">
          <h1 id="zpool-configure-zfs-storage-pools">zpool – configure ZFS storage pools</h1>
<p><strong><em>A ZFS storage pool is a logical collection of devices that provide space for datasets.</em></strong></p>
<p>List pool health status and space usage
<code>zpool list</code></p>
<p>Display the detailed health status
<code>zpool status</code>
<code>zpool status -x</code></p>
<p>Create a new storage pool
<code>zpool create &lt;pool&gt; &lt;disk&gt;</code></p>
<p>Create a new storage pool (RAID1)
<code>zpool create &lt;pool&gt; mirror &lt;first_disk&gt; &lt;second_disk&gt;</code></p>
<p>Grow-up a storage pool
<code>zpool add &lt;pool&gt; &lt;disk&gt;</code></p>
<p>Remove a storage pool
<code>zpool destroy &lt;pool&gt;</code></p>
<p>Import a storage pool
<code>zpool import &lt;pool&gt;|&lt;pool_id&gt;</code></p>
<p>Export a storage pool
<code>zpool export &lt;pool&gt;|&lt;pool_id&gt;</code></p>
<p>Display I/O statistics
<code>zpool iostat &lt;interval&gt;</code></p>
<p>Display the command history
<code>zpool history &lt;pool&gt;</code></p>

        </div>
        <div class="column2">
          <h1 id="zfs-configure-zfs-file-systems">zfs – configure ZFS file systems</h1>
<p><strong><em>A ZFS dataset of type filesystem can be mounted.</em></strong></p>
<p>List the property information for the fs-type datasets
<code>zfs list</code></p>
<p>Create a new ZFS file system
<code>zfs create &lt;pool&gt;/&lt;dataset&gt;</code></p>
<p>Remove a ZFS file system
<code>zfs destroy &lt;pool&gt;/&lt;dataset&gt;</code></p>
<p>Set mount point for a dataset
<code>zfs set mountpoint=&lt;path&gt; &lt;pool&gt;/&lt;dataset&gt;</code></p>
<p>Mount and umount a ZFS file system
<code>zfs mount [-o mountpoint=&lt;dir&gt;]&lt;pool&gt;/&lt;dataset&gt;</code>
<code>zfs umount &lt;pool&gt;/&lt;dataset&gt;</code></p>
<p>Limit the amount of space a dataset can consume
<code>zfs set refquota=&lt;size&gt; &lt;pool&gt;/&lt;dataset&gt;</code></p>
<p>Guaranty minimum amount of space to a dataset
<code>zfs set refreservation=&lt;size&gt; &lt;pool&gt;/&lt;dataset&gt;</code></p>
<h1 id="zfs-configure-zfs-volumes">zfs – configure ZFS volumes</h1>
<p><strong><em>A ZFS dataset of type volume is a logical volume exported as a raw or block device.</em></strong></p>
<p>Create a volume with reservation (thick)
<code>zfs create -V &lt;size&gt; &lt;volume&gt;</code></p>
<p>Creates a sparse volume with no reservation
<code>zfs create -s -V &lt;size&gt; &lt;volume&gt;</code></p>

        </div>
      </main>

      <footer class="print-only">
  <a href="https://groupe-sii.github.io/cheat-sheets">groupe-sii.github.io/cheat-sheets</a>
  <a href="http://www.groupe-sii.com">www.groupe-sii.com</a>
  <a href="https://blog.groupe-sii.com">blog.groupe-sii.com</a>
  <img src="../assets/images/logoSII-white.svg">
</footer>



    </div>

    <hr class="no-print"/>

    <div class="reverse">
      <header class="print-only">
    <div class="header-center">
        <div class="description-content">
            <div class="title">OpenZFS</div>
        </div>
        <div class="logo-container">
            <img src="../assets/images/openzfs.png" >
        </div>
    </div>
</header>


      <main>
        <div class="column1">
          <h1 id="zfs-configure-zfs-snapshots">zfs – configure ZFS snapshots</h1>
<p><strong><em>A snapshot is a read-only copy of a file system.</em></strong></p>
<p><em>File system snapshots can be accessed under the .zfs/snapshot directory in the root of the file system.</em></p>
<p>List snapshots
<code>zfs list -t snapshot</code></p>
<p>Create a snapshot
<code>zfs snapshot &lt;pool&gt;/&lt;dataset&gt;@&lt;snapshot&gt;</code></p>
<p>Rollback a snapshot
<code>zfs rollback &lt;pool&gt;/&lt;dataset&gt;@&lt;snapshot&gt;</code></p>
<p>Remove a snapshot
<code>zfs destroy &lt;pool&gt;/&lt;dataset&gt;@&lt;snapshot&gt;</code></p>
<p>Remove a snapshot and his descendent snapshots
<code>zfs destroy -r &lt;pool&gt;/&lt;dataset&gt;@&lt;snapshot&gt;</code></p>
<h1 id="zfs-configure-zfs-clones">zfs – configure ZFS CLONES</h1>
<p><strong><em>A clone is a writable volume or file system whose initial contents are the same as the original dataset.</em></strong></p>
<p>Create a clone
<code>zfs clone &lt;snapshot&gt; &lt;filesystem&gt;|&lt;volume&gt;</code></p>
<h1 id="zfs-configure-backup-and-restore">zfs – configure backup and restore</h1>
<p><strong><em>ZFS implements data protection feature</em></strong></p>
<p>Backup a snapshot in a file
<code>zfs send &lt;pool&gt;/&lt;dataset&gt;@&lt;snapshot&gt;  &gt;  &lt;file&gt;</code></p>
<p>Restore a file system from a file
<code>zfs recv &lt;pool&gt;/&lt;dataset&gt;  &lt;  &lt;file&gt;</code></p>

        </div>
        <div class="column2">
          <p>Perform increment backup in a file
<code>zfs send -i &lt;snapshot_n&gt; &lt;snapshot_n+1&gt; &gt; &lt;file&gt;</code></p>
<p>Perform differential backup in a file
<code>zfs send -I &lt;snapshot_n&gt; &lt;snapshot_n+p&gt; &gt; &lt;file&gt;</code></p>
<p>Duplicate a snapshot as a new file system
<code>zfs send &lt;pool&gt;/&lt;dataset&gt;@&lt;snapshot&gt; | zfs recv &lt;pool&gt;/&lt;other_dataset&gt;</code></p>
<p>Duplicate a snapshot on a different host
<code>zfs send &lt;pool&gt;/&lt;dataset&gt;@&lt;snapshot&gt; | ssh &lt;host&gt; zfs recv &lt;pool&gt;/&lt;dataset&gt;</code></p>
<h1 id="zfs-set-zfs-file-systems-properties">zfs – set ZFS file systems properties</h1>
<p><strong><em>Properties control ZFS behaviour.</em></strong></p>
<p>List properties of a dataset
<code>zfs get all &lt;pool&gt;/&lt;dataset&gt;</code></p>
<p>Create a NFS share
<code>zfs set sharenfs=on &lt;pool&gt;/&lt;dataset&gt;</code></p>
<p>Activate compression
<code>zfs set compression=gzip &lt;pool&gt;/&lt;dataset&gt;</code></p>
<p>Activate encryption (only at the creation of the dataset), with Oracle ZFS
<code>zfs create -o encryption=on &lt;pool&gt;/&lt;dataset&gt;</code></p>
<p>Activate read-only mode
<code>zfs set readonly=on &lt;pool&gt;/&lt;dataset&gt;</code></p>
<p>Prevent executing from within this file system
<code>zfs set exec=off &lt;pool_name&gt;/&lt;dataset_name&gt;</code></p>

        </div>
      </main>

      <footer class="@@class">
  <a href="https://groupe-sii.github.io/cheat-sheets">groupe-sii.github.io/cheat-sheets</a>
  <a href="http://www.groupe-sii.com">www.groupe-sii.com</a>
  <a href="https://blog.groupe-sii.com">blog.groupe-sii.com</a>
  <img src="../assets/images/logoSII-white.svg">
</footer>

    </div>

    <script src="../common/lib/highlight.pack.js"></script>
    <script src="../common/script.js"></script>
  </body>
</html>
