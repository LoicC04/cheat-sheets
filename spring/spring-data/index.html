<html>
  <head>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Droid+Sans:700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="../../common.css">
    <link rel="stylesheet" href="../../common/lib/atom-one-light.css">
    <link rel="stylesheet" href="../spring.css">
  </head>
  <body>
    <input type="checkbox" id="showPreview"/>
    <div class="first-side">
      <div class="cutter">
<div class="cut cut-top-left">&nbsp;</div>
<div class="cut cut-bottom-left">&nbsp;</div>
<div class="cut cut-top-right">&nbsp;</div>
<div class="cut cut-bottom-right">&nbsp;</div>
</div>
<header>
    <div class="home-button no-print">
        <a href="../" title="back to home cheat Sheet"><i class="material-icons">home</i></a>
        <label for="showPreview"><i class="material-icons">visibility</i></label>
    </div>
    <div class="header-center">
        <div class="description-content">
            <div class="title">Spring Data cheat sheet</div>
            <div class="sub-title">Spring Data, accès aux données sans implémentation</div>
        </div>

        <div class="logo-container">
          <img src="../../assets/images/spring-data.png">
        </div>
    </div>
    <div class="logo-category no-print">
        <i class="material-icons" onclick="printLarge()">print</i>
    </div>
</header>



      <main>
        <div class="column1">
          <h1 id="create-query-from-properties">Create query from properties</h1>
<p>Create your interface implementing the <strong>CrudRepository</strong> :</p>
<pre><code class="lang-Java">public interface PersonRepository extends CrudRepository&lt;User, Long&gt;
</code></pre>
<p>Create a &quot;find by&quot; query :</p>
<pre><code class="lang-Java">List&lt;Person&gt; findByLastname(String lastname);
</code></pre>
<p>Using several class attributes :</p>
<pre><code class="lang-Java">List&lt;Person&gt; findByEmailAddressAndLastname(EmailAddress emailAddress, String lastname);
</code></pre>
<p>Using several properties and distinct:</p>
<pre><code class="lang-Java">List&lt;Person&gt; findDistinctPeopleByLastnameOrFirstname(String lastname, String firstname);
</code></pre>
<p>Ignoring case for all properties :</p>
<pre><code class="lang-Java">List&lt;Person&gt; findByLastnameAndFirstnameAllIgnoreCase(String lastname, String firstname);
</code></pre>
<p>Using ORDER BY for a query</p>
<pre><code class="lang-Java">List&lt;Person&gt; findByLastnameOrderByFirstnameAsc(String lastname);
</code></pre>
<p>Counting :</p>
<pre><code class="lang-Java">Long countByLastname(String lastname);
</code></pre>
<p>Deleting by property :</p>
<pre><code class="lang-Java">Long deleteByLastname(String lastname);
</code></pre>
<p>Using property expressions (zipCode attribute in address object) :</p>
<pre><code class="lang-Java">List&lt;Person&gt; findByAddress_ZipCode(ZipCode zipCode);
</code></pre>
<h1 id="paging-and-sorting-requests">Paging and sorting requests</h1>
<p>Finding data using paging</p>
<pre><code class="lang-Java">List&lt;User&gt; findByLastname(String lastname, Pageable pageable);
</code></pre>
<p>Sorting data</p>
<pre><code class="lang-Java">List&lt;User&gt; findByLastname(String lastname, Sort sort);
</code></pre>
<p>Paging first 10 by property</p>
<pre><code class="lang-Java">Page&lt;User&gt; queryFirst10ByLastname(String lastname, Pageable pageable);
</code></pre>
<h1 id="supported-keywords">Supported Keywords</h1>
<p>The supported keywords are:
And, Or, Is, Equals, Between, LessThan, LessThanEqual, GreaterThan, GreaterThanEqual, findByAgeGreaterThanEqual,
After, Before, IsNull, IsNotNull, NotNull, Like, NotLike, StartingWith, EndingWith, Containing, OrderBy,
Not, In, NotIn, True, False, IgnoreCase</p>

        </div>
        <div class="column2">
          <h1 id="predicates">Predicates</h1>
<p>Implements QueryDslPredicateExecutor:</p>
<pre><code class="lang-Java">interface UserRepository extends CrudRepository&lt;User, Long&gt;, QueryDslPredicateExecutor&lt;User&gt;
</code></pre>
<p>Working with predicates:</p>
<pre><code class="lang-Java">Predicate predicate = user.firstname.equalsIgnoreCase(&quot;dave&quot;)
.and(user.lastname.startsWithIgnoreCase(&quot;mathews&quot;));
userRepository.findAll(predicate);
</code></pre>
<h1 id="using-query">Using @Query</h1>
<p>Implements the JPA repository</p>
<pre><code class="lang-Java">public interface UserRepository extends JpaRepository&lt;User, Long&gt;
</code></pre>
<p>Named queries in an interface</p>
<pre><code class="lang-Java">@Query(&quot;select u from User u where u.firstname like %?1&quot;)
List&lt;User&gt; findByFirstnameEndsWith(String firstname);
</code></pre>
<p>Streaming the result of a query with java 8</p>
<pre><code class="lang-Java">@Query(&quot;select u from User u&quot;)
Stream&lt;User&gt; findAllByCustomQueryAndStream();
</code></pre>
<h1 id="native-queries">Native queries</h1>
<p>Native queries can be executed using an EntityManager</p>
<pre><code class="lang-Java">@PersistenceContext private EntityManager em;
...
Query q = em.createNativeQuery(&quot;SELECT a.id, a.version, a.firstname, a.lastname FROM Author a&quot;, Author.class);
List&lt;Author&gt; authors = q.getResultList();
</code></pre>
<p>Native queries using @Query</p>
<pre><code class="lang-Java">@Query(value = &quot;SELECT * FROM USERS WHERE LASTNAME = ?1&quot;,countQuery = &quot;SELECT count(*) FROM USERS WHERE LASTNAME = ?1&quot;,nativeQuery = true)Page&lt;User&gt; findByLastname(String lastname, Pageable pageable);
</code></pre>

        </div>
      </main>

      <footer class="print-only">
  <a href="https://groupe-sii.github.io/cheat-sheets">groupe-sii.github.io/cheat-sheets</a>
  <a href="http://www.groupe-sii.com">www.groupe-sii.com</a>
  <a href="https://blog.groupe-sii.com">blog.groupe-sii.com</a>
  <img src="../../assets/images/logoSII-white.svg">
</footer>



    </div>

    <script src="../../common/lib/highlight.pack.js"></script>
    <script src="../../common/script.js"></script>
  </body>
</html>
