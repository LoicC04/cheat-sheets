<html>
  <head>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Droid+Sans:700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="../common.css">
    <link rel="stylesheet" href="../common/lib/atom-one-light.css">
    <link rel="stylesheet" href="./mongodb.css">
  </head>
  <body>
    <input type="checkbox" id="showPreview"/>
    <div class="first-side">
      <div class="cutter">
<div class="cut cut-top-left">&nbsp;</div>
<div class="cut cut-bottom-left">&nbsp;</div>
<div class="cut cut-top-right">&nbsp;</div>
<div class="cut cut-bottom-right">&nbsp;</div>
</div>
<header>
    <div class="home-button no-print">
        <a href="../" title="back to home cheat Sheet"><i class="material-icons">home</i></a>
        <label for="showPreview"><i class="material-icons">visibility</i></label>
    </div>
    <div class="header-center">
        <div class="description-content">
            <div class="title">MongoDB cheat sheet</div>
            <div class="sub-title">The document database with scalability and flexibility.</div>
        </div>

        <div class="logo-container">
            <img src="../assets/images/mongodb.png">
        </div>
    </div>
    <div class="logo-category no-print">
        <i class="material-icons" onclick="printLarge()">print</i>
    </div>
</header>



      <main>
        <div class="column1">
          <p>MongoDB version: <strong>3.6+</strong> - Date: <strong>April 2018</strong></p>
<h1 id="main-concepts">Main concepts</h1>
<p><span class="concept">Document</span> : A record in MongoDB is a document, which is a data structure composed of field and value pairs. MongoDB documents are <strong>very</strong> similar to JSON objects. Values may include other documents, arrays, and arrays of documents.</p>
<pre><code>{
    name: &quot;John&quot;,
    age: 77,
    nets: [ &quot;expert&quot;, &quot;developer&quot;, &quot;superhero&quot; ],
    lastExp: { name: &quot;Full-Stack Lead Developer&quot;, duration: 10.5 }
}
</code></pre><p>Note : each document requires a unique <span class="concept">_id</span> field (uses the ObjectId BSON type) that acts as a primary key. The MongoDB driver generates it if omitted.</p>
<p><span class="concept">Collection</span> : A grouping of MongoDB documents. A collection is the equivalent of an RDBMS table. Collections do not enforce a schema by default. Documents within a collection can have different fields but should have a similar or related purpose. </p>
<h1 id="bson-types">BSON types</h1>
<p>Each value of a field/value pair is recorded as a BSON type. BSON is a binary serialization format. The most used and useful BSON types in MongoDB are (each BSON type has both integer and string identifiers) :</p>
<ul>
<li><strong>Double</strong> : 1 &quot;double&quot;    </li>
<li><strong>String</strong> : 2 &quot;string&quot;</li>
<li><strong>Object</strong> : 3 &quot;object&quot;     </li>
<li><strong>Array</strong> : 4 &quot;array&quot;</li>
<li><strong>ObjectId</strong> : 7 &quot;objectId&quot;     </li>
<li><strong>Boolean</strong> : 8 &quot;bool&quot; </li>
<li><strong>Date</strong> : 9 &quot;date&quot; </li>
<li><strong>Null</strong> : 10 &quot;null&quot; </li>
<li><strong>32-bit integer</strong> : 16 &quot;int&quot; </li>
<li><strong>64-bit integer</strong> : 18 &quot;long&quot; </li>
<li><strong>Decimal128</strong> : 19 &quot;decimal&quot;</li>
</ul>
<p>Note : <strong>Timestamp</strong> data type is for internal MongoDB use. You will want to use the BSON date type.</p>

        </div>
        <div class="column2">
          <h1 id="crud-operations">CRUD Operations</h1>
<p><span class="concept">Create</span></p>
<pre><code class="lang-javascript">db.collection.insertOne() 
db.collection.insertMany()
</code></pre>
<pre><code class="lang-javascript">db.users.insertOne(
    { name: &quot;John&quot;, surname: &quot;Doe&quot; }
) 
db.users.insertMany(
    { name: &quot;John&quot;, surname: &quot;Doe&quot; },
    { name: &quot;Jean&quot;, surname: &quot;Dudule&quot; }
)
</code></pre>
<p>Note : If the collection does not currently exist, insert operations will create the collection.</p>
<p><span class="concept">Find</span> (see Query operators)</p>
<pre><code class="lang-javascript">db.collection.find()
</code></pre>
<pre><code class="lang-javascript">db.users.find(
    { age: { $gt: 18 } }
)
</code></pre>
<p><span class="concept">Update</span> (see Query/Update operators)</p>
<pre><code class="lang-javascript">db.collection.updateOne()
db.collection.updateMany()
db.collection.replaceOne()
</code></pre>
<pre><code class="lang-javascript">db.users.updateMany(
    { age: { $gt: 60 } },
    { $set: { retirement: true } }
)
</code></pre>
<p>See <span class="concept">findAndModify</span> to modify and return a single document. By default, the returned document does not include the modifications made on the update.</p>
<p><span class="concept">Delete</span></p>
<pre><code class="lang-javascript">db.collection.deleteOne()
db.collection.deleteMany()
</code></pre>
<pre><code class="lang-javascript">db.users.deleteMany(
    { retirement: true }
)
</code></pre>

        </div>
      </main>

      <footer class="print-only">
  <a href="https://groupe-sii.github.io/cheat-sheets">groupe-sii.github.io/cheat-sheets</a>
  <a href="http://www.groupe-sii.com">www.groupe-sii.com</a>
  <a href="https://blog.groupe-sii.com">blog.groupe-sii.com</a>
  <img src="../assets/images/logoSII-white.svg">
</footer>



    </div>

    <hr class="no-print"/>

    <div class="reverse">
      <header class="print-only">
    <div class="header-center">
        <div class="description-content">
            <div class="title">MongoDB cheat sheet</div>
        </div>
        <div class="logo-container">
            <img src="../assets/images/mongodb.png" >
        </div>
    </div>
</header>


      <main>
        <div class="column1">
          <h1 id="query-operators">Query operators</h1>
<p><span class="concept">Comparison</span></p>
<ul>
<li><strong>$eq</strong>/<strong>$ne</strong> : Equals/Not equals</li>
<li><strong>$gt</strong>/<strong>$gte</strong>/<strong>$lt</strong>/<strong>$lte</strong> : Greater than/g.t. equals/ ...</li>
<li><strong>$in</strong>/<strong>$nin</strong> : Any/None of values specified in an array</li>
</ul>
<p><span class="concept">Logical</span></p>
<ul>
<li><strong>$and</strong>/<strong>$nor</strong>/<strong>$or</strong> : Joins clauses with AND/NOR/OR</li>
<li><strong>$not</strong> : Invert the effect of a query expression</li>
</ul>
<p><span class="concept">Element</span></p>
<ul>
<li><strong>$exists</strong> : Documents that have the specified field</li>
<li><strong>$type</strong> : Field is of the specified type.</li>
</ul>
<p><span class="concept">Array</span></p>
<ul>
<li><strong>$all</strong> : Arrays that contain all elements</li>
<li><strong>$elemMatch</strong> : Element in the array field matches all the specified $elemMatch conditions.</li>
<li><strong>$size</strong> : Array size</li>
</ul>
<p>More operators : $regex, $text (text search), $where (javascript expression), geometries operators, ...</p>
<h1 id="update-operators">Update operators</h1>
<p><span class="concept">Fields</span></p>
<ul>
<li><strong>$currentDate</strong> : Sets value to current date</li>
<li><strong>$inc</strong>/<strong>$mul</strong> : Increments/Multiplies value by specified amount</li>
<li><strong>$min</strong>/<strong>$max</strong> : Updates if the specified value is less/more than existing </li>
<li><strong>$set</strong>/<strong>$unset</strong> : Sets/Removes the value of a field in a document.</li>
</ul>
<p>More operators : $rename, $setOnInsert.</p>
<p><span class="concept">Array</span></p>
<ul>
<li><strong>$</strong>/<strong>$[]</strong>/<strong>$[&lt;identifier&gt;]</strong> : Update first/all/all elements that match the array filters</li>
<li><strong>$push</strong>/<strong>$addToSet</strong> : Adds/Adds if not exists</li>
<li><strong>$pop</strong> : Removes first or last item</li>
<li><strong>$pull/$pullAll</strong> : Removes all/all from an array</li>
</ul>
<p>Modifiers : $each, $position, $slice, $sort</p>

        </div>
        <div class="column2">
          <h1 id="indexes">Indexes</h1>
<p>Appropriate indexes (and index orderings) are essential for efficient queries execution.</p>
<pre><code class="lang-javascript">db.collection.createIndex()
</code></pre>
<pre><code class="lang-javascript">db.users.createIndex( { age: -1 } )
db.users.createIndex( { name: 1, surname: 1 } )
</code></pre>
<p>Note: <span class="concept">_id</span> field is a unique index for every collection.</p>
<h1 id="aggregation-pipeline">Aggregation pipeline</h1>
<p>Aggregation operations process data records, can perform a variety of operations, and return computed results. Documents pass through the stages of the pipeline in sequence.</p>
<pre><code class="lang-javascript">db.collection.aggregate([ { operation: {  } }, ... ])
</code></pre>
<pre><code class="lang-javascript">db.users.aggregate([
    { $group: { _id: &quot;$nets&quot;, age: { $avg: &quot;$age&quot;} } },
    { $match: { age: { $gt: 35 } } }
])
</code></pre>
<p>Note : map-reduce function is an alternative way for aggregation. You will want to use aggregation pipeline.</p>
<h1 id="wanna-become-expert-">Wanna become expert ?</h1>
<ul>
<li><strong>Reporting</strong> : mongostat, and many more utilities</li>
<li><strong>Replication</strong> : redundancy and high availability    </li>
<li><strong>Sharding</strong> : data distribution and horizontal scaling for high query rates and exhausted CPU </li>
<li><strong>Bulk Write</strong> : for multiple ordered rows loads</li>
<li><strong>Change Streams</strong> : access real-time data changes</li>
</ul>
<h1 id="tools-and-documentation">Tools and documentation</h1>
<p><span class="concept">Studio3T</span> : Useful and powerful tool to build queries through a solid UI. <a href="https://studio3t.com/download">studio3t.com/download</a> .</p>
<p><span class="concept">Official documentation</Span> : A &quot;must-have&quot; favorite. Manual : <a href="https://docs.mongodb.com/manual/">docs.mongodb.com/manual</a> and reference : <a href="https://docs.mongodb.com/manual/reference/">docs.mongodb.com/manual/reference</a></p>

        </div>
      </main>

      <footer class="@@class">
  <a href="https://groupe-sii.github.io/cheat-sheets">groupe-sii.github.io/cheat-sheets</a>
  <a href="http://www.groupe-sii.com">www.groupe-sii.com</a>
  <a href="https://blog.groupe-sii.com">blog.groupe-sii.com</a>
  <img src="../assets/images/logoSII-white.svg">
</footer>

    </div>

    <script src="../common/lib/highlight.pack.js"></script>
    <script src="../common/script.js"></script>
  </body>
</html>
