<html>
  <head>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Droid+Sans:700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="../common.css">
    <link rel="stylesheet" href="../common/lib/atom-one-light.css">
    <link rel="stylesheet" href="./docker-swarm.css">
  </head>
  <body>
    <input type="checkbox" id="showPreview"/>
    <div class="first-side">
      <div class="cutter">
<div class="cut cut-top-left">&nbsp;</div>
<div class="cut cut-bottom-left">&nbsp;</div>
<div class="cut cut-top-right">&nbsp;</div>
<div class="cut cut-bottom-right">&nbsp;</div>
</div>
<header>
    <div class="home-button no-print">
        <a href="../" title="back to home cheat Sheet"><i class="material-icons">home</i></a>
        <label for="showPreview"><i class="material-icons">visibility</i></label>
    </div>
    <div class="header-center">
        <div class="description-content">
            <div class="title">docker swarm</div>
            <div class="sub-title">Container orchestration platform</div>
        </div>

        <div class="logo-container">
            <img src="../assets/images/docker-swarm.png">
        </div>
    </div>
    <div class="logo-category no-print">
        <i class="material-icons" onclick="printLarge()">print</i>
    </div>
</header>



      <main>
        <div class="column1">
          <p> docker version: <strong>17.09+</strong> - Date: <strong>October 2017</strong></p>
<h1 id="cluster-initialization">Cluster initialization</h1>
<h2 id="on-the-first-manager-node">On the first Manager node</h2>
<p>Initialize the cluster<br><code>docker swarm init --advertise-addr MANAGER-IP</code></p>
<p>Retrieve the token to add a new Manager node<br><code>docker swarm join-token manager</code></p>
<p>Retrieve the token to add a new Worker node<br><code>docker swarm join-token worker</code></p>
<h2 id="on-every-new-node">On every new node</h2>
<p>Join the node to the cluster<br><code>docker swarm join --token TOKEN</code></p>
<h1 id="cluster-events">Cluster events</h1>
<p>Show real time events
<code>docker events</code></p>
<h1 id="manage-networks">Manage networks</h1>
<p>Create a distributed overlay network
<code>docker network create --driver overlay NETWORK</code></p>

        </div>
        <div class="column2">
          <h1 id="manage-nodes">Manage nodes</h1>
<p>List all nodes<br><code>docker node ls</code></p>
<p>Inspect a node<br><code>docker node inspect NODE</code></p>
<p>List tasks running on a node
<code>docker node ps NODE</code></p>
<p>Promote a node to Manager<br><code>docker node promote NODE</code></p>
<p>Demote a node to Worker<br><code>docker node demote NODE</code></p>
<p>Update a node<br><code>docker node update [options] NODE</code></p>
<ul>
<li>Add a label: <code>docker node update --label-add type=front node-1</code></li>
<li>Drain a node: <code>docker node update --availability drain node-1</code></li>
</ul>
<p>Make a Worker node leave the Cluster<br><code>docker swarm leave</code></p>
<p>Remove a node from nodes list<br><code>docker node rm NODE</code></p>

        </div>
      </main>

      <footer class="print-only">
  <a href="https://groupe-sii.github.io/cheat-sheets">groupe-sii.github.io/cheat-sheets</a>
  <a href="http://www.groupe-sii.com">www.groupe-sii.com</a>
  <a href="https://blog.groupe-sii.com">blog.groupe-sii.com</a>
  <img src="../assets/images/logoSII-white.svg">
</footer>



    </div>

    <hr class="no-print"/>

    <div class="reverse">
      <header class="print-only">
    <div class="header-center">
        <div class="description-content">
            <div class="title">docker cheat sheet</div>
        </div>
        <div class="logo-container">
            <img src="../assets/images/docker-swarm.png" >
        </div>
    </div>
</header>


      <main>
        <div class="column1">
          <h1 id="manage-services">Manage services</h1>
<p>Create a new service<br><code>docker service create [options] IMAGE [COMMAND] [ARGS...]</code></p>
<ul>
<li>Create a busybox service: <code>docker service create --name busybox busybox</code></li>
</ul>
<p>List all services<br><code>docker service ls</code></p>
<p>List the tasks of a service<br><code>docker service ps SERVICE</code></p>
<p>Remove a service<br><code>docker service rm SERVICE</code></p>
<p>Update a service<br><code>docker service update [options] SERVICE</code></p>
<ul>
<li>Update service image <code>docker service update --image my-service:2 my-service</code></li>
</ul>
<p>Scale a service<br><code>docker service scale SERVICE=REPLICAS</code></p>
<p>Inspect a service
<code>docker service inspect SERVICE</code></p>
<p>Fetch the logs of a service or task<br><code>docker service logs SERVICE</code>
<code>docker service logs TASK</code></p>
<p>Roll back a service to its previous version<br><code>docker service rollback SERVICE</code></p>

        </div>
        <div class="column2">
          <h1 id="manage-stacks">Manage stacks</h1>
<p>Deploy a new stack from a compose file<br><code>docker stack deploy --compose-file COMPOSE-FILE STACK</code></p>
<p>List all stacks<br><code>docker stack ls</code></p>
<p>List the services of a stack<br><code>docker stack services STACK</code></p>
<p>List the tasks of a stack<br><code>docker stack ps STACK</code></p>
<p>Remove a stack<br><code>docker stack rm STACK</code></p>
<h1 id="manage-secrets">Manage secrets</h1>
<p>Create a secret from a file or STDIN<br><code>Docker secret create SECRET-NAME FILE-PATH</code>
<code>echo STRING |docker secret create SECRET-NAME -</code></p>
<p>List all secrets<br><code>Docker secret ls</code></p>
<p>Use a secret in a compose file  </p>
<pre><code class="lang-dockerfile">version: &quot;3.1&quot;
services:
  web:
    image: secrets_web
    secrets:
      - mysql-password
secrets:
  mysql-password:
    external: true
</code></pre>

        </div>
      </main>

      <footer class="@@class">
  <a href="https://groupe-sii.github.io/cheat-sheets">groupe-sii.github.io/cheat-sheets</a>
  <a href="http://www.groupe-sii.com">www.groupe-sii.com</a>
  <a href="https://blog.groupe-sii.com">blog.groupe-sii.com</a>
  <img src="../assets/images/logoSII-white.svg">
</footer>

    </div>

    <script src="../common/lib/highlight.pack.js"></script>
    <script src="../common/script.js"></script>
  </body>
</html>
